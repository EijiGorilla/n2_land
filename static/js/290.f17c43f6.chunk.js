"use strict";(self.webpackChunkn2_land=self.webpackChunkn2_land||[]).push([[290],{60290:(t,e,i)=>{i.r(e),i.d(e,{default:()=>F});var a=i(72791),s=i(36801),r=i(59181),n=i(97304),o=i(56343),l=i(66817),h=i(70565),u=i(12657),g=i(54797),c=i(95494),d=i(44323),m=i(62973),v=i(39286),f=i(24470),p=i(38487),_=i(66683),D=i(84668),b=i(74753),I=i(14628),w=i(35105);class x extends p.m{constructor(){super(...arguments),Object.defineProperty(this,"_dataGrouped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_seriesDataGrouped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_groupingCalculated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_intervalDuration",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_baseDuration",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_intervalMax",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_intervalMin",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_afterNew(){this._settings.themeTags=I.Fy(this._settings.themeTags,["axis"]),super._afterNew(),this._setBaseInterval(this.get("baseInterval")),this.on("baseInterval",(()=>{this._setBaseInterval(this.get("baseInterval"))}))}_setBaseInterval(t){this.setPrivateRaw("baseInterval",t),this._baseDuration=w.WI(t)}_fixZoomFactor(){const t=this.get("maxZoomFactor");null!=t&&t!=1/0?this.setPrivateRaw("maxZoomFactor",t):this.setPrivateRaw("maxZoomFactor",Math.round((this.getPrivate("max",0)-this.getPrivate("min",0))/this.baseMainDuration()))}_groupData(){const t=this.getPrivate("min"),e=this.getPrivate("max");if(_.hj(t)&&_.hj(e)){this._fixZoomFactor();const t=this.getPrivate("groupInterval");if(t?this._setBaseInterval(t):this._setBaseInterval(this.get("baseInterval")),this.isDirty("groupInterval")){let t=this.get("groupInterval");t&&(this.setRaw("groupIntervals",[t]),this._handleRangeChange())}if(this.isDirty("groupData")&&!this._dataGrouped){if(this.get("groupData"))s.S6(this.series,(t=>{this._groupSeriesData(t)})),this._handleRangeChange();else{let t=this.get("baseInterval"),e=t.timeUnit+t.count;s.S6(this.series,(t=>{t.setDataSet(e),t.resetGrouping()})),this._setBaseInterval(t),this.setPrivateRaw("groupInterval",void 0),this.markDirtyExtremes()}this._dataGrouped=!0}}}_groupSeriesData(t){if(this.get("groupData")&&!t.get("groupDataDisabled")){this._dataGrouped=!0,this._seriesDataGrouped=!0;let e=[],i=this.baseMainDuration(),a=this.get("groupIntervals");s.S6(a,(t=>{w.WI(t)>i&&e.push(t)})),t._dataSets={};const r=this.getPrivate("name")+this.get("renderer").getPrivate("letter");let n;const o=t.get("baseAxis");t.get("xAxis")===o?n=t._valueYFields:t.get("yAxis")===o&&(n=t._valueXFields);let l=t._mainDataItems,h=this.get("baseInterval"),u=h.timeUnit+h.count;t._dataSets[u]=l;const g=t.get("groupDataCallback");let c=t.get("groupDataWithOriginals",!1);g&&(c=!0);const d=this._root.locale.firstDayOfWeek,m=this._root.utc,v=this._root.timezone;s.S6(e,(e=>{let i,a=-1/0,o=e.timeUnit+e.count;t._dataSets[o]=[];let h={},u={},p={},D={};s.S6(n,(e=>{h[e]=0,u[e]=0,p[e]=t.get(e+"Grouped"),D[e]=e+"Working"}));let I,x,P=w.g9(e.timeUnit);l[0]&&(I=new Date(l[0].get(r))),s.S6(l,(l=>{let M,y=l.get(r),T=w.NM(new Date(y),e.timeUnit,e.count,d,m,I,v).getTime();a<T-P/24?(M=b.JG(l.dataContext),i=new f.z(t,M,t._makeDataItem(M)),i.setRaw(r,T),t._dataSets[o].push(i),s.S6(n,(t=>{let e=l.get(t);_.hj(e)?(i.setRaw(t,e),i.setRaw(D[t],e),u[t]=1,h[t]=e):(h[t]=0,u[t]=0)})),c&&i.set("originals",[l]),g&&x&&g(x,e),x=i):(s.S6(n,(t=>{let e=p[t],a=l.get(t);if(null!=a){let s=i.get(t);switch(e){case"close":i.setRaw(t,a);break;case"sum":i.setRaw(t,s+a);break;case"open":break;case"low":a<s&&i.setRaw(t,a);break;case"high":a>s&&i.setRaw(t,a);break;case"average":u[t]++,h[t]+=a;let e=h[t]/u[t];i.setRaw(t,e);break;case"extreme":Math.abs(a)>Math.abs(s)&&i.setRaw(t,a)}i.setRaw(D[t],i.get(t));let n=b.JG(l.dataContext);n[r]=T,i.dataContext=n}})),c&&i.get("originals").push(l)),a=T})),g&&x&&g(x,e)})),t._dataSetId&&t.setDataSet(t._dataSetId),this.markDirtySize()}}_clearDirty(){super._clearDirty(),this._groupingCalculated=!1,this._dataGrouped=!1}getGroupInterval(t){let e=this.get("baseInterval"),i=w.Pk(0,t,this.get("groupCount",1/0),this.get("groupIntervals"));return w.WI(i)<w.WI(e)&&(i=Object.assign({},e)),i}getIntervalMax(t){return this._intervalMax[t.timeUnit+t.count]}getIntervalMin(t){return this._intervalMin[t.timeUnit+t.count]}_handleRangeChange(){super._handleRangeChange();let t=Math.round(this.getPrivate("selectionMin")),e=Math.round(this.getPrivate("selectionMax"));if(_.hj(t)&&_.hj(e)){if(0==this.get("endLocation")&&(e+=1),this.get("groupData")&&!this._groupingCalculated){this._groupingCalculated=!0;let i=e-t+(this.get("startLocation",0)+(1-this.get("endLocation",1))*this.baseDuration()),a=this.get("groupInterval");a||(a=this.getGroupInterval(i));let r=this.getPrivate("groupInterval");if(a&&(!r||r.timeUnit!==a.timeUnit||r.count!==a.count||this._seriesDataGrouped)){this._seriesDataGrouped=!1,this.setPrivateRaw("groupInterval",a),this._setBaseInterval(a);let t=a.timeUnit+a.count;s.S6(this.series,(e=>{e.get("baseAxis")===this&&e.setDataSet(t)})),this.markDirtyExtremes(),this._root.events.once("frameended",(()=>{this._root.events.once("frameended",(()=>{const t="groupintervalchanged";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this})}))}))}}s.S6(this.series,(i=>{if(i.get("baseAxis")===this){let a=this.getPrivate("name")+this.get("renderer").getPrivate("letter");let r=s.Tb(i.dataItems,(e=>D.qu(e.get(a),t))).index;r>0&&(r-=1),e+=this.baseDuration()*(1-this.get("endLocation",1));let n=s.sK(i.dataItems,(t=>D.qu(t.get(a),e))).index,o=n;o>1&&o--;const l=i.dataItems[r],h=i.dataItems[o];let u,g;l&&(g=l.get(a)),h&&(u=h.get(a));let c=!1;null!=u&&null!=g&&(u<t||g>e)&&(c=!0),i.setPrivate("outOfSelection",c),i.setPrivate("startIndex",r),i.setPrivate("endIndex",n)}}))}}_adjustMinMax(t,e,i,a){return{min:t,max:e,step:(e-t)/i}}intervalDuration(){return this._intervalDuration}_saveMinMax(t,e){let i=this.getPrivate("groupInterval");i||(i=this.get("baseInterval"));let a=i.timeUnit+i.count;this._intervalMin[a]=t,this._intervalMax[a]=e}_getM(t){return"month"==t||"year"==t||"day"==t?1.05:1.01}_prepareAxisItems(){const t=this.getPrivate("min"),e=this.getPrivate("max");if(_.hj(t)&&_.hj(e)){const e=Math.round(this.getPrivate("selectionMin")),i=Math.round(this.getPrivate("selectionMax")),a=this.get("renderer"),r=this.getPrivate("baseInterval");let n=e,o=0;const l=this.get("gridIntervals");let h=w.Pk(0,i-e,a.gridCount(),l);w.WI(h)<this.baseDuration()&&(h=Object.assign({},r));const u=w.WI(h);this._intervalDuration=u;const g=w.XC(h.timeUnit),c=this._root.locale.firstDayOfWeek,d=this._root.utc,m=this._root.timezone;n=w.NM(new Date(e-u),h.timeUnit,h.count,c,d,new Date(t),m).getTime();let v,p=n-u;const D=this.get("dateFormats");for(this.setPrivateRaw("gridInterval",h);n<i+u;){let t;this.dataItems.length<o+1?(t=new f.z(this,void 0,{}),this._dataItems.push(t),this.processDataItem(t)):t=this.dataItems[o],this._createAssets(t,[]),this._toggleDataItem(t,!0),t.setRaw("value",n);let e=n+w.g9(h.timeUnit,h.count*this._getM(h.timeUnit));e=w.NM(new Date(e),h.timeUnit,1,c,d,void 0,m).getTime(),t.setRaw("endValue",e);let i=new Date(n);v=D[h.timeUnit],g&&this.get("markUnitChange")&&_.hj(p)&&"year"!=h.timeUnit&&w.oE(n,p,g,d,m)&&(v=this.get("periodChangeDateFormats")[h.timeUnit]);const a=t.get("label");if(a&&a.set("text",this._root.dateFormatter.format(i,v)),this._prepareDataItem(t,h.count),p=n,n=e,n==p)break;o++}for(let t=o;t<this.dataItems.length;t++)this._toggleDataItem(this.dataItems[t],!1);s.S6(this.series,(t=>{t.inited&&t._markDirtyAxes()}))}this._updateGhost()}_updateFinals(t,e){this.setPrivateRaw("selectionMinFinal",this.positionToValue(t)),this.setPrivateRaw("selectionMaxFinal",this.positionToValue(e))}_getDelta(){this._deltaMinMax=this.baseDuration()/2}_fixMin(t){const e=this.getPrivate("baseInterval"),i=this._root.locale.firstDayOfWeek,a=this._root.timezone,s=this._root.utc,r=e.timeUnit;let n=w.NM(new Date(t),r,e.count,i,s,void 0,a).getTime(),o=n+w.g9(r,e.count*this._getM(r));return o=w.NM(new Date(o),r,1,i,s,void 0,a).getTime(),n+(o-n)*this.get("startLocation",0)}_fixMax(t){const e=this.getPrivate("baseInterval"),i=this._root.locale.firstDayOfWeek,a=this._root.timezone,s=this._root.utc,r=e.timeUnit;let n=w.NM(new Date(t),r,e.count,i,s,void 0,a).getTime(),o=n+w.g9(r,e.count*this._getM(r));return o=w.NM(new Date(o),r,1,i,s,void 0,a).getTime(),n+(o-n)*this.get("endLocation",1)}_updateDates(t,e){}baseDuration(){return this._baseDuration}baseMainDuration(){return w.WI(this.get("baseInterval"))}processSeriesDataItem(t,e){const i=this.getPrivate("baseInterval");t.open||(t.open={}),t.close||(t.close={}),s.S6(e,(e=>{let a=t.get(e);if(_.hj(a)){let s=t.open[e],r=t.close[e];if(a>=s&&a<=r);else{const n=this._root.locale.firstDayOfWeek,o=this._root.utc,l=this._root.timezone,h=i.timeUnit,u=i.count;s=w.NM(new Date(a),h,u,n,o,void 0,l).getTime(),r=s+w.g9(h,u*this._getM(h)),r=w.NM(new Date(r),h,1,n,o,void 0,l).getTime(),t.open[e]=s,t.close[e]=r}this._updateDates(s,t.component)}}))}getDataItemPositionX(t,e,i,a){let s,r;t.open&&t.close?(s=t.open[e],r=t.close[e]):(s=t.get(e),r=s);let n=s+(r-s)*i;return n=this._baseValue+(n-this._baseValue)*a,this.valueToPosition(n)}getDataItemCoordinateX(t,e,i,a){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionX(t,e,i,a))}getDataItemPositionY(t,e,i,a){let s,r;t.open&&t.close?(s=t.open[e],r=t.close[e]):(s=t.get(e),r=s);let n=s+(r-s)*i;return n=this._baseValue+(n-this._baseValue)*a,this.valueToPosition(n)}getDataItemCoordinateY(t,e,i,a){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionY(t,e,i,a))}roundAxisPosition(t,e){let i=this.positionToValue(t);i-=(e-.5)*this.baseDuration();let a=this.getPrivate("baseInterval");if(!_.i2(i)){const t=this._root.locale.firstDayOfWeek,s=a.timeUnit,r=this._root.utc,n=this._root.timezone,o=a.count;i=w.NM(new Date(i),s,o,t,r,new Date(this.getPrivate("min",0)),n).getTime();let l=w.zX(a,new Date(i),t,r,n);return n&&(i=w.NM(new Date(i+.05*this.baseDuration()),s,o,t,r,new Date(this.getPrivate("min",0)),n).getTime(),l=w.zX(a,new Date(i+l*e),t,r,n)),this.valueToPosition(i+l*e)}return NaN}getTooltipText(t,e){if(null!=this.getPrivate("min")){let i=this.get("tooltipDateFormats")[this.getPrivate("baseInterval").timeUnit],a=this.positionToValue(t);if(_.hj(a)){let t=new Date(a),s=this.getPrivate("baseInterval"),r=w.zX(s,t,this._root.locale.firstDayOfWeek,this._root.utc,this._root.timezone);return!1!==e&&(t=new Date(a+this.get("tooltipIntervalOffset",-this.get("tooltipLocation",.5))*r)),this._root.dateFormatter.format(t,this.get("tooltipDateFormat",i))}}return""}getSeriesItem(t,e,i,a){let r=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),n=this.positionToValue(e);null==i&&(i=.5),n-=(i-.5)*this.baseDuration();const o=s.sK(t.dataItems,(t=>{let e=0;return t.open&&(e=t.open[r]),D.qu(e,n)}));if(a||t.get("snapTooltip")){let e=t.dataItems[o.index-1],i=t.dataItems[o.index];if(e&&i&&e.open&&i.close){let t=e.open[r],a=i.close[r];if(Math.abs(n-t)>Math.abs(n-a))return i}if(e)return e;if(i)return i}else{const e=t.dataItems[o.index-1];if(e&&e.open&&e.close){let t=e.open[r],i=e.close[r];if(n>=t&&n<=i)return e}}}shouldGap(t,e,i,a){const s=t.get(a);return e.get(a)-s>this.baseDuration()*i}zoomToDates(t,e,i){this.zoomToValues(t.getTime(),e.getTime(),i)}positionToDate(t){return new Date(this.positionToValue(t))}dateToPosition(t){return this.valueToPosition(t.getTime())}getCellWidthPosition(){let t=this.getPrivate("selectionMax",this.getPrivate("max")),e=this.getPrivate("selectionMin",this.getPrivate("min"));return _.hj(t)&&_.hj(e)?this._intervalDuration/(t-e):.05}}Object.defineProperty(x,"className",{enumerable:!0,configurable:!0,writable:!0,value:"DateAxis"}),Object.defineProperty(x,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:p.m.classNames.concat([x.className])});var P=i(71570),M=i(97873),y=i(80659),T=i(91934),k=i(44520),A=i(36494),S=i(53970),C=i(21149),j=i(18661),N=i(26877),R=i(72812),U=i(80184);const F=()=>{const{municipalSelected:t,barangaySelected:e}=(0,R.tv)(),i=t.municipality,f=e.name,_=(0,a.useRef)({}),D=(0,a.useRef)({}),b=(0,a.useRef)({}),I=(0,a.useRef)({}),[w,F]=(0,a.useState)([]),z="lot-progress";return(0,a.useEffect)((()=>{(0,k.up)(i,f).then((t=>{F(t)}))}),[i,f]),(0,a.useEffect)((()=>{var t,e;e=z,s.S6(r.i_.rootElements,(function(t){t.dom.id===e&&t.dispose()}));var a=n.f.new(z);a.container.children.clear(),null===(t=a._logo)||void 0===t||t.dispose(),a.setThemes([y.Z.new(a),T.Z.new(a)]);var R=a.container.children.push(d.z.new(a,{panX:!1,panY:!1,wheelX:"panX",wheelY:"zoomX",paddingBottom:35,layout:a.verticalLayout}));I.current=R,R.children.unshift(o._.new(a,{text:"Monthly Progress & Target Schedule of Handed Over Lots",fontSize:14,fontWeight:"bold",textAlign:"center",fill:l.$_("#ffffff"),x:h.aQ(50),centerX:h.aQ(50),paddingTop:0,marginBottom:10})),R.set("cursor",m.L.new(a,{behavior:"zoomX"})).lineY.set("visible",!1);var U=v.n.new(a,{strokeOpacity:1,strokeWidth:1,stroke:l.$_("#ffffff")}),F=R.xAxes.push(x.new(a,{maxDeviation:0,groupData:!0,baseInterval:{timeUnit:"day",count:1},groupIntervals:[{timeUnit:"month",count:1}],renderer:U,tooltip:u.u.new(a,{})})),O=R.yAxes.push(p.m.new(a,{min:0,strictMinMax:!0,renderer:P.j.new(a,{minGridDistance:60,strokeOpacity:1,strokeWidth:1,stroke:l.$_("#ffffff")})}));F.get("renderer").labels.template.setAll({textAlign:"center",fill:l.$_("#ffffff"),fontSize:12}),O.get("renderer").labels.template.setAll({textAlign:"center",fill:l.$_("#ffffff"),fontSize:12}),D.current=F,b.current=O,O.children.unshift(o._.new(a,{rotation:-90,y:h.CI,centerX:h.CI,fill:l.$_("#ffffff"),fontSize:11}));var W=R.children.push(g.D.new(a,{centerX:h.CI,centerY:h.aQ(50),x:h.CI,y:h.aQ(108),marginTop:-20}));function X(t,e,s){var r,n=R.series.push(M.d.new(a,{name:t,stacked:!0,xAxis:F,yAxis:O,valueYField:e,valueXField:"date",categoryXField:"date",fill:s,stroke:s}));n.columns.template.events.on("click",(t=>{var a;const s=null===(a=t.target.dataItem)||void 0===a?void 0:a.dataContext,n=new Date(null===s||void 0===s?void 0:s.date),o=(0,k._m)(new Date(n)),l="target"===e?`${N.N4} <= date'`+o+"'":`${N.kr} <= date'`+o+"'",h="Municipality = '"+i+"'",u=h+" AND "+("Barangay = '"+f+"'"),g="target"===e?1:2,c=`${N.Rf} = `+g;let d;var m=A.Aj.createQuery();i&&f?(m.where=u+" AND "+c+" AND "+l,d=u+" AND "+c+" AND "+l):i&&!f?(m.where=h+" AND "+c+" AND "+l,d=h+" AND "+c+" AND "+l):(m.where=c+" AND "+l,d=c+" AND "+l),S.ei.whenLayerView(A.Aj).then((t=>{A.Aj.queryFeatures(m).then((e=>{const i=e.features.length;let a=[];for(var s=0;s<i;s++){var n=e.features[s].attributes.OBJECTID;a.push(n)}var o=new C.Z({objectIds:a});A.Aj.queryExtent(o).then((function(t){t.extent&&S.ei.goTo(t.extent)})),r&&r.remove(),r=t.highlight(a),S.ei.on("click",(function(){t.filter=new j.Z({where:void 0}),r.remove()}))})),t.filter=new j.Z({where:d})}))})),n.columns.template.setAll({tooltipText:'{name}: {valueY} ({valueYTotalPercent.formatNumber("#.#")}%)',tooltipY:h.aQ(10)}),n.data.setAll(w),n.appear(),n.bullets.push((function(){return c.g.new(a,{sprite:o._.new(a,{text:"{valueY}",fill:a.interfaceColors.get("alternativeText"),centerY:h.CI,centerX:h.CI,populateText:!0})})})),W.data.push(n)}return _.current=W,W.labels.template.setAll({oversizedBehavior:"truncate",fill:l.$_("#ffffff"),fontSize:17,scale:.7}),X("Actual","actual",l.$_("#0096FF")),X("Target","target",l.$_("#FF5733")),R.appear(1e3,100),()=>{a.dispose()}}),[z,w]),(0,U.jsx)(U.Fragment,{children:(0,U.jsx)("div",{id:z,style:{height:"40vh",width:"70%",backgroundColor:"#2b2b2b",color:"white",position:"fixed",zIndex:10,bottom:0,marginLeft:"auto",marginRight:"auto"}})})}}}]);
//# sourceMappingURL=290.f17c43f6.chunk.js.map